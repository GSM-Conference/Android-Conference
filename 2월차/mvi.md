디자인 패턴, MVC, MVP, MVVM
========================
**디자인 패턴은, 개발하면서 생기는 공통적인 문제를 해결하기 위한 솔루션**이다.   

**mvc, mvp, mvvm**같은 패턴들은 관심사의 분리를 통해 테스트 코드의 작성을 편하게 해주는 등, 대규모 개발에 있어서 필수 불가결한 요소가 되었다.   

**mvc패턴**의 View와 Model사이의 **높은 결합도**는 **mvp, mvvm 패턴을 파생 시켰고, **데이터와 뷰를 분리함으로써 얻는 장점**으로 인해 헌재는 많은 프로젝트에 mvp, mvvm패턴을 사용하고 있다.   

하지만, mvp, mvvm패턴을 적용하면서 만나게 되는 문제가 두 가지 있다.   

## 상태문제
- 안드로이드는 어떻게 보면 **상태의 집합**이다. 화면에 나타나는 모든 정보나 버튼 활성화등 **상태**들로 구성되어 있다.
- 상태들을 관리하기 힘들어지고, 의도하지 않는 방향으로 제어가 된다면 상태문제가 된다.

![pic](https://velog.velcdn.com/images/evergreen_tree/post/8e86fcc4-7a63-46bd-bcba-a9b75856cf92/image.gif)

상태문제의 좋은 예시로, 로그인이 실패했을 때 지속적으로 다음 화면이 보여지는 상황이 발생한다.

## 부수효과
- 네트워크 통신, 데이터베이스 접근 등의 **부수효과**등으로 인해 발생한다.
- 다이얼로그, 토스트 메시지, 액티비티의 이동도 이에 포함된다.
- 여러 비동기 작업들이 섞여서 어떤 결과를 얻을 지 예상할 수 없고 이에 따라 상태변화에 어려움을 겪는다.   

MVI
======
![pic](https://velog.velcdn.com/images/evergreen_tree/post/63f56523-9cda-479e-8bab-8dd79a9a4331/image.png)

MVI는 **Model, View, Intent**로 이루어져 있으며, 데이터베이스, 네트워크 통신등의 작업을 진행하기 위해 **SideEffect**를 포함합니다.   
- 사용자 또는 시스템의 **Action**을 포함하는 **Intent**가 발생합니다.
- **Intent**를 통해 **Model**이 **reducing**되고, **Model**을 **Observing** 하고 있던 **View**는 **Rendering**을 통해 **View**를 업데이트 한다.   

## View
- Activity나 Fragment, 즉 하나 이상의 **View**   

## Model
- 앱의 단일 **상태**
- 뷰가 화면에 렌더링 해야 하는 것들을 명시해주는 응답으로 다음과 같은 것들이 포함 될 수 있다.
    - 프로그래스 진행률
    - 서버로부터 받은 데이터 목록
    - 예외
- 다른 레이어와의 단방향 레이어 흐름을 위해 **변경 불가** 해야합니다.   

## Intent
- 사용자 또는 앱 내의 상태를 바꾸려는 **의도**
- 모델은 인텐트를 통해서, 새로운 상태로 변화할 수 있다.
    - MVI의 단점 중 하나로, 가벼운 변경 사항도 이를 적용해야 한다.

기존의 MVC나 MVVM 같은 디자인 패턴은, 어떠한 형식에 따라 개발자가 직접 설계하는 방식이었다. MVI패턴같은 경우에도 직접 작성할 수 있으나, MVI 패턴은 제공되는 프레임워크를 통해 설계하는 것이 좋다.   

Pure Cycle, Side effect Cycle
==============================
MVI는 순수 함수로 이루어진 **Pure Cycle**과, 부수효과가 포함되어있는 **SideEffect Cycle**로 표현 할 수 있다.   

## Pure Cycle
순수 함수는 어떤 함수에 동일한 인자를 주었을 때 항상 같은값을 리턴하는 함수이다.

**Pure Cycle**은 순수 함수와 동일한 맥락이다.   

## Side Effect Cycle
항상 모든 흐름이 **Pure Cycle**로 이루어 질 순 없다.   

앱은 **외부세계의 상태를 변화**시켜야 하는 상황이 발생하기도 하고, **외부 세계로부터 상태가 변화**될 수 있다.   

Side Effect Cycle은 기존 Pure Cycle에 Side Effect를 추가한 것이다.   
intent()를 사용해 **새로운 상태를 생성함**과 **동시에 부수 효과를 실행**하고, 인텐트로 결과를 내보내거나 아무일도 일어나지 않는다.

MVI의 장단점
=========

## 장점
- 앱의 상태가 하나뿐이기 때문에, 상태 충돌이 없다.
- 데이터의 흐름이 정해져 있어 흐름을 이해하고 관리하기 쉬움.
- 각각 값이 불변하기 때문에, 스레드 안정성을 갖는다.

## 단점
- 러닝커브가 높다.
- 간단한 앱이라도 Intent와 Model을 가져야 함.
- 작은 변경도 Intent를 거쳐야 함.
- Model Update를 위해 매번 새로운 인스턴스를 생성해야 해서, 너무 많은 객체가 만들어지면 GC가 빈번하게 작동될 수 있다.